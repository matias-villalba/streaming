version: "3"

services:
  mongo:
    image: mongo
    environment:
      - MONGO_INITDB_DATABASE=streaming
    volumes:
      - ./resources/restore_mongodb_dump.sh:/docker-entrypoint-initdb.d/restore_mongodb_dump.sh
      - ./resources/mongodb_dump:/mongodb_dump
    ports:
      - 6017:27017
  streaming-server:
    build: .
    environment:
      - STORAGE_TYPE=database
      - DATABASE_URL=mongodb://mongo:6017
      - LISTENING_PORT=5000
    ports:
      - 5000:5000
    depends_on:
      - mongo
    links:
      - "mongo:mongo"
  html-pages-server:
   image: nginx:alpine
   ports:
      - 9005:80
   depends_on:
      - streaming-server
   volumes:
      - ./client/index.html:/usr/share/nginx/html/index.html